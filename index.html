<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>B.I.A.M. Study Suite</title>
<!-- external tiny-footprint markdown parser -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<!-- ============  DESIGN SYSTEM  ============ -->
<style>
:root{
  /* palette */
  --blue:#3b82f6;          --blue-hover:#2563eb;
  --green:#10b981;         --red:#ef4444;
  --surface:#ffffff;       --surface-h:#f3f4f6;
  --text:#111827;          --muted:#6b7280;
  --border:#e5e7eb;        --shadow:0 4px 10px rgb(0 0 0/.07);
  --radius:0.75rem;
  /* typo & sizing */
  --font-base:clamp(.9rem,2.2vw,.98rem);
  --line:1.55;
  --container:960px;
}
/* dark */
@media (prefers-color-scheme:dark){
 :root{
  --surface:#1f2937;  --surface-h:#374151;
  --text:#f9fafb;     --muted:#9ca3af; --border:#374151;
  --shadow:0 4px 16px rgb(0 0 0/.4);
 }
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  font-size:var(--font-base);line-height:var(--line);
  background:var(--surface);color:var(--text);display:flex;flex-direction:column;
  -webkit-font-smoothing:antialiased;scroll-behavior:smooth;
}
a{text-decoration:none;color:var(--blue)}
button{font:inherit;cursor:pointer;transition:.2s ease all}
svg{pointer-events:none}

header{
  background:var(--blue);color:#fff;padding:0.8rem 1rem;
  display:flex;align-items:center;justify-content:space-between;
  box-shadow:var(--shadow);z-index:100;
}
header h1{font-size:1.1rem;letter-spacing:.01em;font-weight:600}
.btn-icon{background:none;border:0;color:inherit;font-size:1.2rem;line-height:1}

nav{
  background:var(--surface-h);box-shadow:var(--shadow);overflow-x:auto;
  display:flex;gap:.25rem;padding:.25rem 0;position:sticky;top:0;z-index:90;
}
nav button{
  flex:1 0 115px;padding:.55rem .75rem;background:none;border:0;
  color:var(--muted);font-weight:600;white-space:nowrap;border-radius:var(--radius);
}
nav button.active,nav button:hover{
  background:var(--blue);color:#fff;
}

main{flex:1;width:100%;display:flex;justify-content:center;padding:1rem}
.view{display:none;max-width:var(--container);width:100%}
.view.active{display:block}

.card-stack{perspective:1200px;display:flex;flex-direction:column;align-items:center;gap:1rem}
.card{
  width:100%;max-width:450px;height:260px;position:relative;
  border-radius:var(--radius);box-shadow:var(--shadow);
  transform-style:preserve-3d;transition:.6s transform;
  background:var(--surface-h);display:flex;align-items:center;justify-content:center;
  text-align:center;padding:1rem;font-size:1.15rem;font-weight:500
}
.card.flipped{transform:rotateY(180deg)}
.card .side{
  position:absolute;width:100%;height:100%;backface-visibility:hidden;
  display:flex;align-items:center;justify-content:center
}
.card .back{transform:rotateY(180deg)}

.fc-toolbar{display:flex;flex-wrap:wrap;gap:.75rem;justify-content:center}
.btn{
  border:1px solid var(--border);border-radius:var(--radius);padding:.55rem 1.25rem;
  background:var(--surface);color:var(--text);font-weight:600
}
.btn.blue{background:var(--blue);color:#fff;border-color:var(--blue)}
.btn.outline{background:none;border:2px solid var(--blue);color:var(--blue)}
.btn.blue:hover{background:var(--blue-hover)}
.btn.outline:hover{background:var(--blue);color:#fff}

.quiz-block{display:flex;flex-direction:column;gap:1.25rem;margin-bottom:2.5rem}
.option-btn{
  border:1px solid var(--border);padding:.9rem;border-radius:var(--radius);
  background:var(--surface-h);text-align:left;width:100%;
}
.option-btn:hover:not(.disabled){background:var(--surface)}
.correct{background:rgba(16,185,129,.85)!important;color:#fff;border-color:var(--green)!important}
.wrong{background:rgba(239,68,68,.85)!important;color:#fff;border-color:var(--red)!important}
.option-btn.disabled{opacity:.6;cursor:not-allowed}

.score{text-align:center;font-weight:700;margin-top:-1rem}

.wa-wrap, .tf-wrap{display:flex;flex-direction:column;gap:1rem}
textarea{
  width:100%;padding:1rem;border-radius:var(--radius);
  background:var(--surface-h);border:1px solid var(--border);min-height:140px;
  resize:vertical;color:inherit
}

.notes-box{
  background:var(--surface-h);border-radius:var(--radius);
  padding:2rem;box-shadow:var(--shadow);position:relative
}
#sel-ask{
  position:fixed;top:0;left:0;transform:translate(-50%,-50%);
  display:none;padding:.45rem .9rem;font-weight:600;
  border-radius:var(--radius);background:var(--blue);color:#fff;
  box-shadow:var(--shadow);z-index:9999;border:0
}

/* small devices */
@media(max-width:650px){
  .card{height:200px}
  .btn{flex:1}
}
</style>
</head>

<body>
<header>
  <h1>B.I.A.M. Study Suite</h1>
  <button id="theme-btn" class="btn-icon" aria-label="Toggle colour scheme">ðŸŒ™</button>
</header>

<nav>
  <button data-view="flash"  class="active">Flashcards</button>
  <button data-view="mcq">Multiple&nbsp;Choice</button>
  <button data-view="written">Written</button>
  <button data-view="tf">True / False</button>
  <button data-view="notes">Notes</button>
</nav>

<main>
  <!-- Flashcards -->
  <section id="flash" class="view active">
    <div class="card-stack">
      <div class="card" id="fc-card">
        <div class="side front" id="fc-q"></div>
        <div class="side back"  id="fc-a"></div>
      </div>
      <div class="fc-toolbar">
        <button id="fc-prev" class="btn">Prev</button>
        <button id="fc-next" class="btn blue">Next</button>
        <button id="fc-ask"  class="btn outline">Ask ChatGPT</button>
      </div>
    </div>
  </section>

  <!-- Multiple-Choice -->
  <section id="mcq" class="view">
    <div id="mcq-wrapper"></div>
    <p class="score" id="mcq-score"></p>
  </section>

  <!-- Written -->
  <section id="written" class="view">
    <div class="wa-wrap">
      <p id="wa-q" style="font-weight:bold"></p>
      <textarea id="wa-input" placeholder="Jot your answer hereâ€¦"></textarea>
      <button id="wa-show" class="btn blue">Show Answer</button>
      <div id="wa-a" style="font-weight:600"></div>
      <div style="display:flex;gap:.75rem;justify-content:center">
        <button class="btn" id="wa-prev">Prev</button>
        <button class="btn blue" id="wa-next">Next</button>
        <button class="btn outline" id="wa-ask">Ask ChatGPT</button>
      </div>
    </div>
  </section>

  <!-- True / False -->
  <section id="tf" class="view">
    <div class="tf-wrap">
      <p id="tf-q" style="font-weight:bold"></p>
      <div style="display:flex;gap:1rem">
        <button class="btn option-btn" data-val="true">True</button>
        <button class="btn option-btn" data-val="false">False</button>
      </div>
      <p id="tf-feedback"></p>
      <div style="display:flex;gap:.75rem;justify-content:center">
        <button class="btn" id="tf-prev">Prev</button>
        <button class="btn blue"  id="tf-next">Next</button>
        <button class="btn outline" id="tf-ask">Ask ChatGPT</button>
      </div>
    </div>
  </section>

  <!-- Notes -->
  <section id="notes" class="view">
    <article id="notes-container" class="notes-box">Loading â€¦</article>
  </section>
</main>

<!-- floating ask selection -->
<button id="sel-ask">Ask ChatGPT</button>

<!-- ============  APP  ============ -->
<script>
/* ---------- resources ---------- */
let DATA;
(async()=>DATA=await (await fetch('data.json')).json())();

/* ---------- theme toggle ---------- */
const btnTheme=document.getElementById('theme-btn');
btnTheme.onclick=()=>document.documentElement.classList.toggle('dark');

/* ---------- nav ---------- */
document.querySelectorAll('nav button').forEach(btn=>{
  btn.onclick=()=>{
    document.querySelector('nav button.active').classList.remove('active');
    btn.classList.add('active');
    document.querySelector('.view.active').classList.remove('active');
    document.getElementById(btn.dataset.view).classList.add('active');
  };
});

/* ---------- helpers ---------- */
const shuffle=a=>{for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}};
const link=q=>`https://chatgpt.com/?model=gpt-4o&temporary-chat=true&q=${encodeURIComponent(q)}`;

/* ---------- FLASHCARDS ---------- */
(async()=>{
 await new Promise(r=>{const id=setInterval(()=>DATA&&(clearInterval(id),r()),50)});
 shuffle(DATA.flashcards);
 let idx=0;const card=document.getElementById('fc-card'),qel=document.getElementById('fc-q'),ael=document.getElementById('fc-a');
 const show=i=>{const c=DATA.flashcards[i];qel.textContent=c.q;ael.textContent=c.a;card.classList.remove('flipped');};
 show(0);
 card.onclick=()=>card.classList.toggle('flipped');
 document.getElementById('fc-prev').onclick=()=>show(idx=(idx-1+DATA.flashcards.length)%DATA.flashcards.length);
 document.getElementById('fc-next').onclick=()=>show(idx=(idx+1)%DATA.flashcards.length);
 document.getElementById('fc-ask').onclick=()=>window.open(link(`${qel.textContent}\n\nAnswer: ${ael.textContent}`),'_blank');
})();

/* ---------- MCQ ---------- */
(async()=>{
 await new Promise(r=>{const id=setInterval(()=>DATA&&(clearInterval(id),r()),50)});
 shuffle(DATA.multipleChoice);
 const wrap=document.getElementById('mcq-wrapper'),scoreEl=document.getElementById('mcq-score');
 let score=0;
 DATA.multipleChoice.forEach((q,i)=>{
  shuffle(q.choices);
  const block=document.createElement('div');block.className='quiz-block';
  block.innerHTML=`<p>${i+1}. ${q.question}</p>`;
  const opts=document.createElement('div');opts.style.display='grid';opts.style.gap='.75rem';
  const optBtns=[];
  q.choices.forEach(ch=>{
    const b=document.createElement('button');b.className='option-btn';b.textContent=ch;
    b.onclick=()=>{
      optBtns.forEach(x=>x.disabled=true);
      if(ch===q.answer){b.classList.add('correct');score++;}
      else{b.classList.add('wrong');optBtns.find(x=>x.textContent===q.answer).classList.add('correct');}
      scoreEl.textContent=`Score ${score}/${DATA.multipleChoice.length}`;
    };
    optBtns.push(b);opts.appendChild(b);
  });
  block.appendChild(opts);
  const ask=document.createElement('button');ask.textContent='Ask ChatGPT';ask.className='btn outline';
  ask.onclick=()=>window.open(link(`${q.question}\nOptions: ${q.choices.join(', ')}\nAnswer: ${q.answer}`),'_blank');
  block.appendChild(ask);
  wrap.appendChild(block);
 });
})();

/* ---------- WRITTEN ---------- */
(async()=>{
 await new Promise(r=>{const id=setInterval(()=>DATA&&(clearInterval(id),r()),50)});
 shuffle(DATA.writtenAnswer);
 let i=0;const qel=document.getElementById('wa-q'),ta=document.getElementById('wa-input'),ans=document.getElementById('wa-a');
 const show=k=>{const it=DATA.writtenAnswer[k];qel.textContent=it.q;ans.textContent='';ta.value='';};
 show(0);
 document.getElementById('wa-show').onclick=()=>ans.textContent=DATA.writtenAnswer[i].a;
 document.getElementById('wa-next').onclick=()=>show(i=(i+1)%DATA.writtenAnswer.length);
 document.getElementById('wa-prev').onclick=()=>show(i=(i-1+DATA.writtenAnswer.length)%DATA.writtenAnswer.length);
 document.getElementById('wa-ask').onclick=()=>window.open(link(`${DATA.writtenAnswer[i].q}\nAnswer: ${DATA.writtenAnswer[i].a}`),'_blank');
})();

/* ---------- TRUE/FALSE ---------- */
(async()=>{
 await new Promise(r=>{const id=setInterval(()=>DATA&&(clearInterval(id),r()),50)});
 shuffle(DATA.trueFalse);
 let i=0;const qel=document.getElementById('tf-q'),fb=document.getElementById('tf-feedback'),
       btns=[...document.querySelectorAll('#tf button[data-val]')];
 const show=k=>{const q=DATA.trueFalse[k];qel.textContent=q.q;fb.textContent='';btns.forEach(b=>{b.disabled=false;b.classList.remove('correct','wrong')});};
 const handle=e=>{
  const correct=DATA.trueFalse[i].a,val=e.target.dataset.val==='true';
  if(val===correct){e.target.classList.add('correct');fb.textContent='âœ“ Correct';}
  else{e.target.classList.add('wrong');fb.textContent=`âœ— Wrong â€” ${correct?'True':'False'}`;}
  btns.forEach(b=>b.disabled=true);
 };
 btns.forEach(b=>b.onclick=handle);
 document.getElementById('tf-next').onclick=()=>show(i=(i+1)%DATA.trueFalse.length);
 document.getElementById('tf-prev').onclick=()=>show(i=(i-1+DATA.trueFalse.length)%DATA.trueFalse.length);
 document.getElementById('tf-ask').onclick=()=>window.open(link(`${DATA.trueFalse[i].q}\nAnswer: ${DATA.trueFalse[i].a?'True':'False'}`),'_blank');
 show(0);
})();

/* ---------- NOTES ---------- */
(async()=>{
 const box=document.getElementById('notes-container');
 const md=await (await fetch('notes.md')).text();
 box.innerHTML=marked.parse(md);
 const selBtn=document.getElementById('sel-ask');
 document.addEventListener('selectionchange',()=>{
  const sel=getSelection();
  if(!sel||sel.isCollapsed||!box.contains(sel.anchorNode)){selBtn.style.display='none';return;}
  const r=sel.getRangeAt(0).getBoundingClientRect();
  selBtn.style.display='block';selBtn.style.top=`${r.bottom+window.scrollY+8}px`;selBtn.style.left=`${r.left+window.scrollX}px`;
 });
 selBtn.onclick=()=>{
  const t=getSelection().toString().trim();
  if(t)window.open(link(`Explain:\n${t}`),'_blank');
 };
})();
</script>
</body>
</html>
