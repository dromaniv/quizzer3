<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>B.I.A.M Study Suite</title>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<!-- -----------------  DESIGN TOKENS  ----------------- -->
<style>
:root{
  /* light */
  --brand:#2563eb;      --brand-h:#1e40af;
  --bg:#f9fafb;         --bg-h:#eff1f5;
  --card:#ffffff;       --card-h:#e5e7eb;
  --text:#0f172a;       --text-sub:#475569;
  --border:#d1d5db;
  --green:#16a34a;      --red:#dc2626;
  --radius:.75rem;      --shadow:0 4px 14px rgb(0 0 0/.06);
  --transition-speed: 0.3s; /* Added transition speed variable */
}
/* dark */
html.dark{
  --bg:#0f172a;  --bg-h:#1e293b;
  --card:#1e293b;--card-h:#334155;
  --text:#f1f5f9;--text-sub:#94a3b8;
  --border:#475569;--shadow:0 4px 18px rgb(0 0 0/.55);
}
*{box-sizing:border-box;margin:0;padding:0} html,body{height:100%}
body{
  font:400 1rem/1.55 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  background:var(--bg);color:var(--text);display:flex;flex-direction:column;
  -webkit-font-smoothing:antialiased;
}

/* ---------- header & theme switch ---------- */
header{padding:1rem 1.2rem;background:var(--brand);display:flex;justify-content:space-between;align-items:center;color:#fff;box-shadow:var(--shadow);z-index:200}
header h1{font-size:1.15rem;font-weight:600}
.switch{
  --w:52px;--h:28px;position:relative;display:inline-block;width:var(--w);height:var(--h);cursor:pointer
}
.switch input{display:none}
.slider{
  background:#fde047;border-radius:var(--h);height:100%;transition:.3s
}
.slider::before{
  content:"";position:absolute;top:3px;left:3px;width:22px;height:22px;border-radius:50%;background:#fff;transition:.3s
}
.slider svg{position:absolute;top:50%;transform:translateY(-50%);pointer-events:none}
.sun{left:9px;fill:#facc15;font-size:14px}
.moon{right:9px;fill:#cbd5e1;font-size:14px}
input:checked + .slider{background:#334155}
input:checked + .slider::before{transform:translateX(24px)}

/* ---------- nav ---------- */
nav{position:sticky;top:0;z-index:150;background:var(--card);display:flex;border-bottom:1px solid var(--border)}
nav button{flex:1;padding:.9rem .5rem;background:none;border:0;font-weight:600;color:var(--text-sub);cursor:pointer}
nav button:hover{background:var(--bg-h)}
nav button.active{color:var(--brand);position:relative}
nav button.active::after{content:'';position:absolute;left:0;right:0;bottom:0;height:3px;background:var(--brand)}

main{flex:1;padding:1.25rem;display:flex;justify-content:center}
.view{display:none;width:100%;max-width:960px;margin:auto}
.view.active{display:block}

.btn{
  border-radius:var(--radius);font-weight:600;font-size:.95rem;padding:.65rem 1.35rem;
  display:inline-flex;align-items:center;justify-content:center;transition:.25s;cursor:pointer;border:1px solid transparent
}
.fill   {background:var(--brand);color:#fff;border-color:var(--brand)}
.fill:hover{background:var(--brand-h);border-color:var(--brand-h)}
.neutral{background:var(--bg-h);color:var(--text);border-color:var(--border)}
.neutral:hover{background:var(--card-h)}
.ghost  {background:none;color:var(--brand);border:2px solid var(--brand)}
.ghost:hover{background:var(--brand);color:#fff}

/* Flashcards */
.card-box{perspective:1200px;width:100%;max-width:500px;margin:auto}
.card{
  position:relative;width:100%;height:260px;border-radius:var(--radius);box-shadow:var(--shadow);background:var(--card);
  transform-style:preserve-3d;transition:transform .6s;display:flex;align-items:center;justify-content:center;padding:1.25rem;text-align:center;font-size:1.15rem;font-weight:500
}
.card.flipped{transform:rotateY(180deg)}
.side{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:1.25rem;backface-visibility:hidden}
.back{transform:rotateY(180deg)}
.row{display:flex;gap:.75rem;flex-wrap:wrap;justify-content:center;margin-top:1rem}

/* MCQ */
.block{margin-bottom:2.5rem;display:flex;flex-direction:column;gap:1rem}
.option{
  width:100%;padding:1rem;border-radius:var(--radius);background:var(--card-h);border:1px solid var(--border);
  color:var(--text);text-align:left;font:inherit;cursor:pointer;transition:.2s
}
.option:hover:not(.disabled){background:var(--bg-h)}
.option.disabled{cursor:not-allowed;opacity:.75}
.correct{background:var(--green)!important;color:#fff;border-color:var(--green)!important}
.wrong{background:var(--red)!important;color:#fff;border-color:var(--red)!important}

/* textarea */
textarea{
  width:100%;min-height:150px;padding:1rem;background:var(--card-h);border-radius:var(--radius);
  border:1px solid var(--border);resize:vertical;color:inherit
}

/* notes */
.notes{background:var(--card);padding:2rem;border-radius:var(--radius);box-shadow:var(--shadow);line-height:1.6}

/* collapsible animation */
.collapsible {
  max-height: 0;
  overflow: hidden;
  transition: max-height var(--transition-speed) ease;
}
.collapsible.expanded {
  max-height: 1000px; /* Large enough to fit any content */
}

/* floating selection btn */
#selAsk{position:fixed;z-index:9999;display:none;padding:.55rem 1.1rem;background:var(--brand);color:#fff;border:0;border-radius:var(--radius);font-weight:600;box-shadow:var(--shadow)}
@media(max-width:600px){.card{height:200px}.btn{flex:1}}
</style>
</head>

<body>
<header>
  <h1>B.I.A.M Study Suite</h1>
  <label class="switch">
    <input type="checkbox" id="themeChk">
    <span class="slider">
      <svg class="sun"  width="14" height="14" viewBox="0 0 24 24"><path d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12Z"/><path d="M12 2v2m0 16v2m10-10h-2M4 12H2m3.64-6.36L5 5m12.36 12.36L19 19m0-14-1.36 1.36M5 19l1.36-1.36"/></svg>
      <svg class="moon" width="14" height="14" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 0 1 11.21 3 7 7 0 1 0 21 12.79Z"/></svg>
    </span>
  </label>
</header>

<nav>
  <button data-view="flash"  class="active">Flashcards</button>
  <button data-view="mcq">Multiple-Choice</button>
  <button data-view="written">Written</button>
  <button data-view="tf">True/False</button>
  <button data-view="notes">Notes</button>
</nav>

<main>
  <!-- FLASHCARDS -->
  <section id="flash" class="view active">
    <div class="card-box">
      <div class="card" id="fcCard">
        <div class="side front" id="fcQ"></div>
        <div class="side back"  id="fcA"></div>
      </div>
    </div>
    <div class="row"><button id="fcPrev" class="btn neutral">Prev</button><button id="fcNext" class="btn fill">Next</button></div>
    <div class="row" style="margin-top:.5rem"><button id="fcAsk" class="btn ghost">Ask ChatGPT</button></div>
  </section>

  <!-- MCQ -->
  <section id="mcq" class="view"><div id="mcqWrap"></div><p id="mcqScore" style="font-weight:700;text-align:center"></p></section>

  <!-- WRITTEN -->
  <section id="written" class="view">
    <div class="block">
      <p id="waQ" style="font-weight:600"></p>
      <textarea id="waInput" placeholder="Your answer…"></textarea>
      <button id="waToggle" class="btn fill">Show model answer</button>
      <div id="waA" class="collapsible" style="font-weight:600;padding-top:1rem;"></div>
      <div class="row"><button id="waPrev" class="btn neutral">Prev</button><button id="waNext" class="btn fill">Next</button></div>
      <div class="row" style="margin-top:.5rem"><button id="waAsk" class="btn ghost">Ask ChatGPT</button></div>
    </div>
  </section>

  <!-- TRUE/FALSE -->
  <section id="tf" class="view">
    <div class="block">
      <p id="tfQ" style="font-weight:600"></p>
      <div class="row"><button class="btn option" data-val="true">True</button><button class="btn option" data-val="false">False</button></div>
      <p id="tfFeedback" style="font-weight:700"></p>
      <div class="row"><button id="tfPrev" class="btn neutral">Prev</button><button id="tfNext" class="btn fill">Next</button></div>
      <div class="row" style="margin-top:.5rem"><button id="tfAsk" class="btn ghost">Ask ChatGPT</button></div>
    </div>
  </section>

  <!-- NOTES -->
  <section id="notes" class="view"><article id="notesBox" class="notes">Loading…</article></section>
</main>

<button id="selAsk">Ask ChatGPT</button>

<!-- ----------------------- APP ----------------------- -->
<script>
const $=s=>document.querySelector(s), $$=s=>[...document.querySelectorAll(s)];
const shuffle=a=>{for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}};
const ask=p=>window.open('https://chatgpt.com/?model=gpt-4o&temporary-chat=true&q='+encodeURIComponent(p),'_blank');
const dataPromise=fetch('data.json').then(r=>r.json());

/* theme persistence */
const chk=$('#themeChk');
const applyTheme=mode=>{document.documentElement.classList.toggle('dark',mode==='dark');chk.checked=mode==='dark';localStorage.theme=mode};
applyTheme(localStorage.theme||'light');
chk.onchange=()=>applyTheme(chk.checked?'dark':'light');

/* nav switching + clear selection */
$$('nav button').forEach(btn=>btn.onclick=()=>{$('nav .active').classList.remove('active');btn.classList.add('active');$('.view.active').classList.remove('active');$('#'+btn.dataset.view).classList.add('active');getSelection().removeAllRanges();$('#selAsk').style.display='none';});

/* FLASHCARDS */
(async()=>{
 const arr=(await dataPromise).flashcards;shuffle(arr);let i=0;
 const card=$('#fcCard'),q=$('#fcQ'),a=$('#fcA');
 const render=()=>{const c=arr[i];q.textContent=c.q;a.textContent=c.a;card.classList.remove('flipped')};render();
 card.onclick=()=>card.classList.toggle('flipped');
 $('#fcPrev').onclick=()=>{i=(i-1+arr.length)%arr.length;render()};
 $('#fcNext').onclick=()=>{i=(i+1)%arr.length;render()};
 $('#fcAsk').onclick=()=>ask(`Explain the following concept from biologically-inspired algorithms in simple terms:\n"${arr[i].q}"`);
})();

/* MCQ */
(async()=>{
 const arr=(await dataPromise).multipleChoice;shuffle(arr);
 const wrap=$('#mcqWrap'),score=$('#mcqScore');let sc=0;
 arr.forEach((q,idx)=>{
  shuffle(q.choices);
  const blk=document.createElement('div');blk.className='block';blk.innerHTML=`<p>${idx+1}. ${q.question}</p>`;
  const optWrap=document.createElement('div');optWrap.style.display='grid';optWrap.style.gap='.75rem';
  const opts=[];
  q.choices.forEach(c=>{
    const btn=document.createElement('button');btn.className='btn option';btn.textContent=c;
    btn.onclick=()=>{
      opts.forEach(o=>{o.disabled=true;o.classList.add('disabled')});
      btn.classList.add(c===q.answer?'correct':'wrong');
      if(c===q.answer)sc++;else opts.find(o=>o.textContent===q.answer).classList.add('correct');
      score.textContent=`Score ${sc}/${arr.length}`;
    };
    opts.push(btn);optWrap.appendChild(btn);
  });
  const askBtn=document.createElement('button');askBtn.className='btn ghost';askBtn.textContent='Ask ChatGPT';
  askBtn.onclick=()=>ask(`Multiple-choice question on biologically-inspired algorithms:\n${q.question}\nOptions: ${q.choices.join(', ')}\nExplain why the correct answer ("${q.answer}") is right and others are wrong.`);
  blk.append(optWrap,askBtn);wrap.appendChild(blk);
 });
})();

/* WRITTEN */
(async()=>{
 const arr=(await dataPromise).writtenAnswer;shuffle(arr);let i=0;
 const q=$('#waQ'),aBox=$('#waA'),tBtn=$('#waToggle');

 const render=()=>{
   q.textContent=arr[i].q;
   aBox.textContent = '';
   aBox.classList.remove('expanded');
   tBtn.textContent='Show model answer';
 };

 render();

 tBtn.onclick=()=>{
   const isExpanded = aBox.classList.contains('expanded');

   if(!isExpanded) {
     // Set content before expanding
     aBox.textContent = arr[i].a;
   }

   // Toggle expanded class for animation
   aBox.classList.toggle('expanded');

   // Update button text
   tBtn.textContent = isExpanded ? 'Show model answer' : 'Hide answer';
 };

 $('#waPrev').onclick=()=>{i=(i-1+arr.length)%arr.length;render()};
 $('#waNext').onclick=()=>{i=(i+1)%arr.length;render()};
 $('#waAsk').onclick=()=>ask(`I'm studying biologically-inspired algorithms. Could you explain the following question for me?\n"${arr[i].q}"`);
})();

/* TRUE/FALSE */
(async()=>{
 const arr=(await dataPromise).trueFalse;shuffle(arr);let i=0;
 const q=$('#tfQ'),fb=$('#tfFeedback'),btns=$$('#tf button.option');
 const render=()=>{q.textContent=arr[i].q;fb.textContent='';btns.forEach(b=>{b.disabled=false;b.classList.remove('correct','wrong','disabled')})};
 btns.forEach(b=>b.onclick=()=>{
  const ans=b.dataset.val==='true',ok=arr[i].a;
  btns.forEach(x=>{x.disabled=true;x.classList.add('disabled')});
  b.classList.add(ans===ok?'correct':'wrong');fb.textContent=ans===ok?'✓ Correct':`✗ Incorrect — it is ${ok}`;
 });
 $('#tfPrev').onclick=()=>{i=(i-1+arr.length)%arr.length;render()};
 $('#tfNext').onclick=()=>{i=(i+1)%arr.length;render()};
 $('#tfAsk').onclick=()=>ask(`Is the following statement about biologically-inspired algorithms true or false? Explain.\n"${arr[i].q}"`);
 render();
})();

/* NOTES + floating ask */
(async()=>{
 const box=$('#notesBox');box.innerHTML=marked.parse(await (await fetch('notes.md')).text());
 const float=$('#selAsk');
 document.addEventListener('selectionchange',()=>{
  const sel=getSelection();
  if(!sel||sel.isCollapsed||!box.contains(sel.anchorNode)){float.style.display='none';return;}
  const r=sel.getRangeAt(0).getBoundingClientRect();
  float.style.top=`${r.bottom+scrollY+8}px`;float.style.left=`${r.left+scrollX}px`;float.style.display='block';
 });
 float.onclick=()=>{const txt=getSelection().toString().trim();if(txt)ask(`Explain this excerpt from my notes on biologically-inspired algorithms:\n"${txt}"`)};
})();
</script>
</body>
</html>
